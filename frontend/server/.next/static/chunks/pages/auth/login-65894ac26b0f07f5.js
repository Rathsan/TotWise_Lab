(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[344],{163:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth/login",function(){return s(1739)}])},1739:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return c}});var i=s(5893),a=s(9008),t=s.n(a),r=s(1163),l=s(7294);function c(){let e=(0,r.useRouter)(),[n,s]=(0,l.useState)(""),[a,c]=(0,l.useState)(""),[o,u]=(0,l.useState)(!1),[d,h]=(0,l.useState)(!1),p=(0,l.useRef)(!1);async function f(s){if(s.preventDefault(),!n)return;u(!0),c("We’ll check your access and sign you in."),e.replace("/auth/pending");let i=await fetch("/api/free-guide/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})}),a=await i.json().catch(()=>({status:"error"}));if("logged_in"===a.status){e.replace("paid"===a.destination?"/paid":"/free-guide");return}if("no_access"===a.status){e.replace("/auth/no-access");return}if(!i.ok){e.replace("/auth/pending");return}e.replace("/auth/pending")}return(0,l.useEffect)(()=>{if(!e.isReady||d||p.current)return;let n="string"==typeof e.query.email?e.query.email:"";n&&(p.current=!0,s(n),h(!0),u(!0),c("We’ll check your access and sign you in."),fetch("/api/free-guide/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})}).then(e=>e.json()).then(n=>{if("logged_in"===n.status){e.replace("paid"===n.destination?"/paid":"/free-guide");return}if("no_access"===n.status){c("We couldn’t find active access for this email."),u(!1);return}c("Check your email — your secure login link is on its way \uD83D\uDC9B"),u(!1)}))},[e.isReady,e.query.email,d]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t(),{children:[(0,i.jsx)("title",{children:"Login — TotWise Lab"}),(0,i.jsx)("link",{rel:"stylesheet",href:"/login/login.css"})]}),(0,i.jsxs)("div",{className:"login-container",children:[(0,i.jsxs)("header",{className:"login-header",children:[(0,i.jsx)("div",{className:"brand",children:(0,i.jsx)("span",{className:"brand-name",children:"TotWise Lab"})}),(0,i.jsx)("p",{className:"brand-subtitle",children:"Parent Toolkit Access"})]}),(0,i.jsx)("main",{className:"login-main",children:(0,i.jsxs)("div",{className:"login-card",children:[(0,i.jsxs)("h1",{children:["Welcome back ",(0,i.jsx)("span",{className:"emoji",children:"\uD83C\uDF31"})]}),(0,i.jsx)("p",{className:"welcome-text",children:"Enter your email and we’ll take care of the rest."}),(0,i.jsxs)("form",{className:"login-form",onSubmit:f,children:[(0,i.jsx)("div",{className:"input-group",children:(0,i.jsx)("div",{className:"input-wrapper",children:(0,i.jsx)("input",{type:"email",placeholder:"your@email.com",value:n,onChange:e=>s(e.target.value),required:!0})})}),(0,i.jsx)("button",{type:"submit",className:"submit-btn",disabled:o,children:(0,i.jsx)("span",{children:o?"Checking…":"Continue"})})]}),(0,i.jsx)("p",{className:"login-message",children:a}),(0,i.jsx)("p",{className:"login-helper",children:"No passwords. Secure link sent only if needed."})]})})]})]})}},9008:function(e,n,s){e.exports=s(3867)},1163:function(e,n,s){e.exports=s(3079)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=163)}),_N_E=e.O()}]);